---

title: linux命令
date: 2015-08-20
categories: [server]
tags: [linux]

---



## linux命令 ##

查找
find / -name nginx

删除文件              rm -f 

删除件夹              rm -rf

查看文件行数    wc - lcw file1

#### more 分页浏览文件内容

ls -lh 就能显示出文件大小

查看后几行 tail -100 error.log 

文件权限   chmod

sz 下载文件到本地.zip

zip -r name.zip name

None自己计算机中安装完整的Linux发行版或其Live CD体验。关于登录账户密码的说明,

实验楼环境中所有的默认系统用户名均为shiyanlou，密码为shiyanlou认提供了6个纯命令行界面的"terminal"（准确的说这里应该是6个virtual consoles）来让用户登录，

在物理机系统上你可以通过使用[Ctrl]+[Alt]+[F1]～[F6]进行切换

#### 使用Tab键来进行命令补全

这时候你就可以使用Ctrl+c键来强行终止当前程序（你可以放心它并不会使终端退出）

按键     作用

Ctrl+d     键盘输入结束或退出终端

Ctrl+s     暂定当前程序，暂停后按下任意键恢复运行

Ctrl+z     将当前程序放到后台运行，恢复到前台为命令fg

Ctrl+a     将光标移至输入行头，相当于Home键

Ctrl+e     将光标移至输入行末，相当于End键

Ctrl+k     删除从光标所在位置到行末

Alt+Backspace     向前删除一个单词

Shift+PgUp     将终端显示向上滚动

Shift+PgDn     

#### 将终端显示向下滚动、

#### shell常用通配符：

字符     含义

*     匹配 0 或多个字符

?     匹配任意一个字符

[list]     匹配 list 中的任意单一字符

[!list]     匹配 除list 中的任意单一字符以外的字符

[c1-c2]     匹配 c1-c2 中的任意单一字符 如：[0-9] [a-z]

{string1,string2,...}     匹配 sring1 或 string2 (或更多)其一字符串

{c2..c2}     匹配 c1-c2 中全部字符 如{1..10}

man   手册

通常分8个区

区段     说明

1     一般命令

2     系统调用

3     库函数，涵盖了C标准函数库

4     特殊文件（通常是/dev中的设备）和驱动程序

5     文件格式和约定

6     游戏和屏保

7     杂项

8     系统管理命<你要搜索的关键字>令和守护进程

所有的手册页遵循一个常见的布局，其为通过简单的ASCII文本展示而优化

手册中搜索，查找到后你可以使用n键切换到下一个关键字所在处，shift+n为上一个关键字所在处。使用Space(空格键)翻页，Enter(回车键)向下滚动一行，

或者使用j,k（vim编辑器的移动键）进行向前向后滚动一行。按下h键为显示使用帮助(因为man使用less作为阅读器，实为less工具的帮助)，按下q退出

，你还可以使用info命令，不过通常使用man就足够了。如果你知道某个命令的作用，只是想快速查看一些它的某个具体参数的作用，那么你可以使用--help参数，

大部分命令都会带有这个参数

这一节介绍一个可以输出图形字符的命令banner

输入的第一列表示打开当前伪终端的用户的用户名（要查看当前登录用户的用户名，去掉空格直接使用whoami即可），

第二列的pts/0中pts表示伪终端，所谓伪是相对于/dev/tty设备而言的，还记得上一节讲终端时的那七个使用[Ctrl]+[Alt]+[F1]～[F7]进行切换的/dev/tty设备么,这是“真终端”

，伪终端就是当你在图形用户界面使用/dev/tty7时每打开一个终端就会产生一个伪终端，pts/0后面那个数字就表示打开的伪终端序号，你可以尝试再打开一个终端，然后在里面输入who am i，

看第二列是不是就变成pts/1了，第三列则表示当前伪终端的启动时间。

#### who命令其它常用参数

参数     说明

-a     打印能打印的全部

-d     打印死掉的进程

-m     同am i,mom likes

-q     打印当前登录用户数及用户名

-u     打印当前登录用户登录信息

-r     打印运行等级

关于文件类型，这里有一点你必需时刻牢记linux里面一切皆文件，

正因为这一点才有了设备文件（/dev目录下有各种设备文件，

大都跟具体的硬件设备相关）这一说，还有socket（网络套接字，具体是什么，感兴趣的用户可以自己去了解或期待实验楼的后续相关课程），

和pipe(管道，这个东西很重要，我们以后将会讨论到，这里你先知道有它的存在即可)。软链接文件，链接文件是分为两种的，

另一种当然是“硬链接”(硬链接不常用，具体内容不作为本课程讨论重点，

而软链接等同于windows上的快捷方式,你记住这一点就够了

####文件权限

读权限，表示你可以使用cat 之类的命令来读取某个文件的内容;写权限，表示你可以编辑和修改某个文件；

 执行权限，通常指可以运行的二进制程序文件或者脚本文件，如同windows上的'exe'后缀的文件，不过linux上不是通过文件后缀名来区分文件的类型。

你需要注意的一点是，一个目录要同时具有读权限和执行权限才可以打开，而一个目录要有写权限才允许在其中创建其它文件，

这是因为目录文件实际保存着该目录里面的文件的列表等信息

新建空白文件

使用touch命令创建空白文件，关于touch命令，

其主要是来更改已有文件的时间戳的（比如，最近访问时间，

最近修改时间），但其在不加任何参数的情况下，只指定一个文件名，

则可以创建一个为指定文件名的空白文件(不会覆盖已有同名文件)，

当然你也可以同时指定该文件的时间戳，

更多关于touch命令的用法，会在下一讲文件搜索中涉及。

mkdir创建目录

cp复制文件或目录要成功复制目录需要加上-r或者-R参数，表示递归复制，

就是说有点“株连九族”的意思，连它的子子孙孙都不放过

rm删除 文件或目录跟复制目录一样，要删除一个目录，也需要加上-r或-R参数

mv移动文件

这两个命令都是用来打印文件内容到标准输出（终端）,其中cat(注意不是猫哈)为正序显示，tac倒序显示，这里只介绍cat

使用head和tail命令查看文件

这两个命令那些性子比较急的人应该会比较喜欢，因为它们一个是只查看的头几行（默认为10行，不足10行则显示全部）和尾几行。

还是拿passwd文件举例，比如当我们想要查看最近新增加的用户，那么我们可以查看这个/etc/passwd文件，不过我们前面也看到了，这个文件里面一大堆乱糟糟的东西，看起来实在费神啊。

这里想到系统新增加一个用户，应该会将用户的信息添加到passwd文件的最后，那么这时候我们就可以使用tail命令了

使用file查看文件

要解释环境变量，得先明白变量是什么，准确的说应该是shell变量，所谓变量就是计算机中用于记录一个值（不一定是数值，也可以是字符或字符串）的符号，

而这些符号将用于不同的运算处理中。通常变量与值是一对一的关系，可以通过表达式读取它的值赋值给其它变量，也可以直接指定数值赋值给任意变量。

为了便于运算和处理，大部分的编程语言会区分变量的类型，用于分别记录数值、字符或者字符串等等数据类型

使用 declare创建变量

命令     说明

set     显示当前shell所有环境变量，包括其内建环境变量（与shell外观等相关），用户自定义变量及导出的环境变量

env     显示与当前用户相关的环境变量，还可以让命令在指定环境中运行

export     显示从shell中导出成环境变量的变量，也能通过它将自定义变量导出为环境变量

用查看PATH环境变量的内容

变量设置方式     说明

${变量名#匹配字串}     从头向后开始匹配，删除符合匹配字串的最短数据

${变量名##匹配字串}     从头向后开始匹配，删除符合匹配字串的最长数据

${变量名%匹配字串}     从尾向前开始匹配，删除符合匹配字串的最短数据

${变量名%%匹配字串}     从尾向前开始匹配，删除符合匹配字串的最长数据

${变量名/旧的字串/新的字串}     将符合旧字串的第一个字串替换为新的字串

${变量名//旧的字串/新的字串}     将符合旧字串的全部字串替换为新的字串

可以使用unset命令删除一个环境变量

与搜索相关的命令常用的有如下几个whereis,which,find,locate

参数     说明

-atime     最后访问时间

-ctime     创建时间

-mtime     最后修改时间

下面以-mtime参数举例

    -mtime n: n 为数字，表示为在n天之前的”一天之内“修改过的文件
    
    -mtime +n: 列出在n天之前（不包含n天本身）被修改过的文件
    
    -mtime -n: 列出在n天之前（包含n天本身）被修改过的文件
    
    newer file: file为一个已存在的文件，列出比file还要新的文件名

文件后缀名     说明

*.zip     zip程序打包压缩的文件

*.rar     rar程序压缩的文件

*.7z     bzip2程序压缩的文件

*.tar     tar程序打包，未压缩的文件

*.gz     gzip程序(GNU zip)压缩的文件

*.xz     xz程序压缩的文件

*.bz2     bzip2程序压缩的文件

*.tar.gz     tar打包，gzip程序压缩的文件

*.tar.xz     tar打包，xz程序压缩的文件

*tar.bz2     tar打包，bzip2程序压缩的文件

*.tar.7z     tar打包，7z程序压缩的文件

这里虽然讲了这么多种压缩文件，这么多个命令，不过不要害怕，我们一般只需要掌握几个命令即可，包括zip,rar,tar。下面会依次介绍这几个命令及对应的解压命令

查看磁盘的容量df

du查看目录容量

dd命令用于转换和复制文件，不过它的复制不同于cp。之前提到过关于Linux的很重要的一点，一切即文件

dd的命令行语句与其他的Linux程序不同，因为它的命令行选项格式为选项=值，而不是更标准的--选项 值或-选项=值。dd默认从标准输入中读取，并写入到标准输出中，

但可以用选项if（input file，输入文件）和of（output file，输出文件）改变

使用mkfs命令格式化磁盘

你可以在命令行输入mkfs然后按下Tab键，你可以看到很多个以mkfs为前缀的命令，这些不同的后缀其实就是表示着不同的文件系统，可以用mkfs格式化成的文件系统

使用mount命令挂载磁盘到目录树使用umount命令卸载已挂载磁盘使用fdisk为磁盘分区（关于分区的一些概念不清楚的用户请参看主引导记录

使用losetup命令建立镜像与回环设备的关联

.cut命令，打印每一行的某一字段

grep命令是很强大的，也是相当常用的一个命令，它结合正则表达式可以实现很复杂却很高效的匹配和查找，不过在学习正则表达式之前，这里介绍它简单的使用，

而关于正则表达式后面将会有单独一小节介绍到时会再继续学习grep命令和其他一些命令

wc命令用于统计并输出一个文件中行、单词和字节的数目

sort排序命令uniq命令可以用于过滤或者输出重复行

tr命令可以用来删除一段文本信息中的某些文字。或者讲其进行转换

-d     删除和set1匹配的字符，注意不是全词匹配也不是按字符顺序匹配

-s     去除set1指定的在输入文本中连续并重复的字符

你可能对重定向这个概念感到些许陌生，但你应该在前面的课程中多次见过>或>>操作了，并知道他们分别是将标准输出导向一个文件或追加到一个文件中。这其实就是重定向，

将原本输出到标准输出的数据重定向到一个文件中

，前面我们已经提到过linux默认提供了三个特殊设备，用于终端的显示和输出，分别为stdin(标准输入,对应于你在终端的输入)，stdout（标准输出，对应于终端的输出），

stderr(标准错误输出，对应于终端的输出)。

文件描述符     设备文件     说明

0     /dev/stdin     标准输入

1     /dev/stdout     标准输出

2     /dev/stderr     标准错误

注意你应该在输出重定向文件描述符前加上&,否则shell会当做重定向到一个文件名为1的文件中

使用tee命令同时重定向到多个文件

在linux中有一个被成为“黑洞”的设备文件,所以导入它的数据都将被“吞噬”

虽然我们这一节的标题是正则表达式，但实际我们这一节的内容并不会主要介绍它，而是只介绍grep,sed,awk这三个命令，

而正则表达式作为这三个命令的一种使用方式（命令输出中可以包含正则表达式）

一个正则表达式通常被称为一个模式（pattern），为用来描述或者匹配一系列符合某个句法规则的字符串。

选择

|竖直分隔符表示选择，例如"boy|girl"可以匹配"boy"或者"girl"

数量限定

数量限定除了我们举例用的*,还有+加号,?问号,.点号，如果在一个模式中不加数量限定符则表示出现一次且仅出现一次：

    +表示前面的字符必须出现至少一次(1次或多次)，例如，"goo+gle",可以匹配"gooogle","goooogle"等；
    
    ?表示前面的字符最多出现一次(0次或1次)，例如，"colou?r",可以匹配"color"或者"colour";
    
    *星号代表前面的字符可以不出现，也可以出现一次或者多次（0次、或1次、或多次），例如，“0*42”可以匹配42、042、0042、00042等。

范围和优先级

()圆括号可以用来定义模式字符串的范围和优先级，这可以简单的理解为是否将括号内的模式串作为一个整体。

例如，"gr(a|e)y"等价于"gray|grey"，（这里体现了优先级，竖直分隔符用于选择a或者e而不是gra和ey），"(grand)?father"匹配father和grandfather

（这里体验了范围，?将圆括号内容作为一个整体匹配）。

语法（部分）

正则表达式有多种不同的风格，下面列举一些常用的作为PCRE子集的适用于perl和python编程语言及grep或egrep的正则表达式匹配规则：(由于markdown表格解析的问题，下面的竖直分隔符用全角字符代替，实际使用时请换回半角字符

字符     描述

\     将下一个字符标记为一个特殊字符、或一个原义字符。例如，“n”匹配字符“n”。“\n”匹配一个换行符。序列“\\”匹配“\”而“\(”则匹配“(”。

^     匹配输入字符串的开始位置。

$     匹配输入字符串的结束位置。

{n}     n是一个非负整数。匹配确定的n次。例如，“o{2}”不能匹配“Bob”中的“o”，但是能匹配“food”中的两个o。

{n,}     n是一个非负整数。至少匹配n次。例如，“o{2,}”不能匹配“Bob”中的“o”，但能匹配“foooood”中的所有o。“o{1,}”等价于“o+”。“o{0,}”则等价于“o*”。

{n,m}     m和n均为非负整数，其中n<=m。最少匹配n次且最多匹配m次。例如，“o{1,3}”将匹配“fooooood”中的前三个o。“o{0,1}”等价于“o?”。请注意在逗号和两个数之间不能有空格。

*     匹配前面的子表达式零次或多次。例如，zo*能匹配“z”、“zo”以及“zoo”。*等价于{0,}。

+     匹配前面的子表达式一次或多次。例如，“zo+”能匹配“zo”以及“zoo”，但不能匹配“z”。+等价于{1,}。

?     匹配前面的子表达式零次或一次。例如，“do(es)?”可以匹配“do”或“does”中的“do”。?等价于{0,1}。

?     当该字符紧跟在任何一个其他限制符（*,+,?，{n}，{n,}，{n,m}）后面时，匹配模式是非贪婪的。非贪婪模式尽可能少的匹配所搜索的字符串，

而默认的贪婪模式则尽可能多的匹配所搜索的字符串。例如，对于字符串“oooo”，“o+?”将匹配单个“o”，而“o+”将匹配所有“o”。

.     匹配除“\n”之外的任何单个字符。要匹配包括“\n”在内的任何字符，请使用像“(.｜\n)”的模式。

(pattern)     匹配pattern并获取这一匹配的子字符串。该子字符串用于向后引用。要匹配圆括号字符，请使用“\(”或“\)”。

x｜y     匹配x或y。例如，“z｜food”能匹配“z”或“food”。“(z｜f)ood”则匹配“zood”或“food”。

[xyz]     字符集合（character class）。匹配所包含的任意一个字符。例如，“[abc]”可以匹配“plain”中的“a”。

其中特殊字符仅有反斜线\保持特殊含义，用于转义字符。其它特殊字符如星号、加号、各种括号等均作为普通字符。脱字符^如果出现在首位则表示负值字符集合；

如果出现在字符串中间就仅作为普通字符。连字符 - 如果出现在字符串中间表示字符范围描述；如果如果出现在首位则仅作为普通字符。

[^xyz]     排除型（negate）字符集合。匹配未列出的任意字符。例如，“[^abc]”可以匹配“plain”中的“plin”。

[a-z]     字符范围。匹配指定范围内的任意字符。例如，“[a-z]”可以匹配“a”到“z”范围内的任意小写字母字符。

[^a-z]     排除型的字符范围。匹配任何不在指定范围内的任意字符。例如，“[^a-z]”可以匹配任何不在“a”到“z”范围内的任意字符。

优先级

优先级为从上到下从左到右，依次降低

运算符     说明

\     转义符

(), (?:), (?=), []     括号和中括号

*、+、?、{n}、{n,}、{n,m}     限定符

^、$、\任何元字符     定位点和序列

｜     　选择

基本操作

grep命令用于打印输出文本中匹配的模式串，它使用正则表达式作为模式匹配的条件。grep支持三种正则表达式引擎，分别用三个参数指定：

参数     说明

-E     POSIX扩展正则表达式，ERE

-G     POSIX基本正则表达式，BRE

-P     Perl正则表达式，PCRE

不过在你没学过perl语言的大多数情况下你将只会使用到ERE和BRE,所以我们接下来的内容都不会讨论到PCRE中特有的一些正则表达式语法

（它们之间大部分内容是存在交集的，所以你不用担心会遗漏多少重要内容）

在通过grep命令使用正则表达式之前，先介绍一下它的常用参数

参数     说明

-b     将二进制文件作为文本来进行匹配

-c     统计以模式匹配的数目

-i     忽略大小写

-n     显示匹配文本所在行的行号

-v     反选，输出不匹配行的内容

-r     递归匹配查找

-A n     n为正整数，表示after的意思，除了列出匹配行之外，还列出后面的n行

-B n     n为正整数，表示before的意思，除了列出匹配行之外，还列出前面的n行

--color=auto     将输出中的匹配项设置为自动颜色显示

特殊符号     说明

[:alnum:]     代表英文大小写字节及数字，亦即 0-9, A-Z, a-z

[:alpha:]     代表任何英文大小写字节，亦即 A-Z, a-z

[:blank:]     代表空白键与 [Tab] 按键两者

[:cntrl:]     代表键盘上面的控制按键，亦即包括 CR, LF, Tab, Del.. 等等

[:digit:]     代表数字而已，亦即 0-9

[:graph:]     除了空白字节 (空白键与 [Tab] 按键) 外的其他所有按键

[:lower:]     代表小写字节，亦即 a-z

[:print:]     代表任何可以被列印出来的字节

[:punct:]     代表标点符号 (punctuation symbol)，亦即：" ' ? ! ; : # $...

[:upper:]     代表大写字节，亦即 A-Z

[:space:]     任何会产生空白的字节，包括空白键, [Tab], CR 等等

[:xdigit:]     代表 16 进位的数字类型，因此包括： 0-9, A-F, a-f 的数字与字节

编辑器sed 命令基本格式

参数     说明

-n     安静模式，只打印受影响的行，默认打印输入数据的全部内容

-e     用于在脚本中添加多个执行命令一次执行，在命令行中执行多个命令通常不需要加该参数

-f filename     指定执行filename文件中的命令

-r     使用扩展正则表达式，默认为标准正则表达式

-i     将直接修改输入文件内容，而不是打印到标准输出设备

命令     说明

s     行内替换

c     整行替换

a     插入到指定行的后面

i     插入到指定行的前面

p     打印指定行，通常与-n参数配合使用

d     删除指定行

AWK是一种优良的文本处理工具，Linux及Unix环境中现有的功能最强大的数据处理引擎之一.

awk所有的操作都是基于pattern(模式)—action(动作)对来完成的，如下面的形

其中-F参数用于预先指定前面提到的字段分隔符（还有其他指定字段的方式） ，-v用于预先为awk程序指定变量，-f参数用于指定awk命令要执行的程序文件，

或者在不加-f参数的情况下直接将程序语句放在这里，最后为awk需要处理的文本输入，且可以同时输入多个文本文件

变量名     说明

FILENAME     当前输入文件名，若有多个文件，则只表示第一个。如果输入是来自标准输入，则为空字符串

$0     当前记录的内容

$N     N表示字段号，最大值为NF变量的值

FS     字段分隔符，由正则表达式表示，默认为" "空格

RS     输入记录分隔符，默认为"\n"，即一行为一个记录

NF     当前记录字段数

NR     已经读入的记录数

FNR     当前输入文件的记录数，请注意它与NR的区别

OFS     输出字段分隔符，默认为" "空格

ORS     输出记录分隔符，默认为"\n"

通常linux上的软件安装主要有三种方式：

    在线安装
    
    从磁盘安装deb软件包
    
    从二进制软件包安装
    
    从源代码编译安装

3.apt-get

apt-get使用各用于处理apt包的公用程序集，我们可以用它来在线安装、卸载和升级软件包等，下面列出一些apt-get包含的常用的一些工具：

工具     说明

install     其后加上软件包名，用于安装一个软件包

update     从软件源镜像服务器上下载/更新用于更新本地软件源的软件包列表

upgrade     升级本地可更新的全部软件包，但存在依赖问题时将不会升级，通常会在更新之前执行一次update

dist-upgrade     解决依赖关系并升级(存在一定危险性)

remove     移除已安装的软件包，包括与被移除软件包有依赖关系的软件包，但不包含软件包的配置文件

autoremove     移除之前被其他软件包依赖，但现在不再被使用的软件包

purge     与remove相同，但会完全移除软件包，包含其配置文件

clean     移除下载到本地的已经安装的软件包，默认保存在/var/cache/apt/archives/

autoclean     移除已安装的软件的旧版本软件包

下面是一些apt-get常用的参数：

参数     说明

-y     自动回应是否安装软件包的选项，在一些自动化安装脚本中使用这个参数将十分有用

-s     模拟安装

-q     静默安装方式，指定多个q或者-q=#,#表示数字，用于设定静默级别，这在你不想要在安装软件包时屏幕输出过多时很有用

-f     修复损坏的依赖关系

-d     只下载不安装

--reinstall     重新安装已经安装但可能存在问题的软件包

--install-suggests     同时安装APT给出的建议安装的软件包

dpkg常用参数介绍

参数     说明

-i     安装指定deb包

-R     后面加上目录名，用于安装该目录下的所有deb安装包

-r     remove，移除某个已安装的软件包

-I     显示deb包文件的信息

-s     显示已安装软件的信息

-S     搜索已安装的软件包

-L     显示已安装软件包的目录信息